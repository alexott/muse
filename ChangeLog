2006-08-30  Michael Olson  <mwolson@gnu.org>

	* muse.texi (Blosxom Requirements): Fix typo.

	* contrib/pyblosxom/getstamps.py (recurse): Ignore metadata
	directories for bzr and darcs.

	* contrib/pyblosxom/make-blog, contrib/pyblosxom/hardcodedates.py:
	contrib/pyblosxom/getstamps.py: Update version and headers.

2006-08-27  Michael Olson  <mwolson@gnu.org>

	* lisp/muse-colors.el (muse-configure-highlighting): Prune out any
	nil values before they get to mapconcat.  This fixes a lockup when
	muse-wiki-match-all-project-files is nil.

	* lisp/muse-wiki.el (muse-wiki-match-all-project-files)
	(muse-wiki-ignore-implicit-links-to-current-page)
	(muse-wiki-interwiki-regexp, muse-wiki-interwiki-alist)
	(muse-wiki-resolve-project-page, muse-wiki-handle-interwiki)
	(muse-wiki-publish-small-title-words)
	(muse-wiki-publish-pretty-title): Docfix.
	(muse-wiki-update-local-wikiword-regexp): Rename from
	muse-wiki-update-local-wikiword-regexp.  Set
	muse-wiki-project-file-regexp instead of
	muse-wiki-wikiword-regexp, as suggested by Per Sederberg.  Don't
	take muse-wiki-use-wikiword into account, since this is a
	different concept now.
	(muse-wiki-update-wikiword-regexp): Remove.
	(muse-wiki-wikiword-regexp): In-line the :set function.
	(muse-wiki-handle-wikiword): Use muse-wiki-project-file-regexp.

2006-08-26  Michael Olson  <mwolson@gnu.org>

	* lisp/muse-publish.el (muse-publish-surround-text): When looking
	for indented list items, ignore blank lines.

	* lisp/muse-wiki.el (muse-wiki-update-local-wikiword-regexp)
	(muse-wiki-update-interwiki-regexp): Use regexp-opt instead of
	mapconcat.  This should hopefully fix a problem with large amounts
	of files with spaces in their name.  Thanks to Greg Detre for the
	report.

2006-08-24  Michael Olson  <mwolson@gnu.org>

	* lisp/muse-blosxom.el (muse-blosxom-new-entry): Remove the
	numbers from the argument to format-time-string.  This fixes an
	XEmacs bug.  Thanks to Michael Welle for the report and analysis.

2006-08-18  Michael Olson  <mwolson@gnu.org>

	* lisp/muse-project.el (muse-project-file-entries): Since we are
	given a full path, match against the filename as well.  This fixes
	an issue where backup files were being added to the file alist.

	* lisp/muse-docbook.el (muse-docbook-markup-regexps): Apply a fix
	from muse-html.el.

2006-08-12  Michael Olson  <mwolson@gnu.org>

	* Makefile (.PHONY): Don't use line continuations.
	(realclean fullclean): Call realclean in subdirs, not distclean.
	(distclean): Don't call realclean, since this would wipe out our
	autoloads file.
	(dist): Use correct path to autoloads file.

	* NEWS: Catch up with the latest changes.

	* experimental/Makefile (.PHONY): Wrap long line.

	* lisp/Makefile (distclean): Do the same thing as "clean", not
	"realclean".

	* lisp/muse-project.el (muse-project-get-applicable-style):
	Indentation tweak.
	(muse-project-ignore-regexp, muse-project-recurse-directory):
	Docfix.
	(muse-project-of-file): Try the ignored files regexp against the
	base filename as well as the entire path.

	* lisp/muse-publish.el (muse-publish-this-file): Display message
	if the buffer is not associated with any file, so that we avoid
	errors later on.
	(muse-publish-url-desc): New function taken from muse-publish-url
	that causes a URL description to be transformed.
	(muse-publish-url): Call muse-publish-url-desc on either the
	description or the original URL if it will be used as a
	description.  Accept the original URL as an argument, in case it
	was transformed earlier.
	(muse-publish-insert-url): Pass original URL as an argument.
	(muse-publish-markup-link): Make this somewhat easier to follow.
	Pass original URL as argument.
	(muse-publish-get-style): If the same style is used to publish to
	two different directories, prompt the user for which directory to
	use.
	(muse-publish-markup-header-footer-tags): Sync lisp tag with the
	latest changes.
	(muse-publish-markup-url): Pass original URL as an argument.  This
	fixes the "nil" description for bare URLs that was in 3.02.91.
	Nothing like finding a bug just after completing the announcement
	of a release.

	* lisp/muse.el: Use defalias whenever convenient.
	(muse-version): Set version to 3.02.92 (3.03 RC2).

2006-08-10  Michael Olson  <mwolson@gnu.org>

	* lisp/muse-html.el (muse-html-finalize-buffer): Since the html
	style does not derive from any other class, return `t' here.
	This, along with the corresponding change to muse-publish.el,
	fixes a problem with the table of contents getting inserted
	multiple times for custom html-based styles.
	(muse-html-markup-strings, muse-xhtml-markup-strings): Use a
	smarter method for table centering that works with XHTML.

	* lisp/muse-latex2png.el Rename all functions to have a
	"muse-latex2png" prefix.  Turn all variables into customizable
	options in the muse-latex2png group.
	(muse-latex2png-img-dest): New option specifying where to place
	the images.
	(muse-latex2png-template): New option containing the template to
	use for the surrounding LaTeX code.
	(muse-latex2png-use-xhtml): New option that toggles strict XHTML
	compliance.
	(muse-latex2png-move2pubdir): Avoid multiple redundant error
	messages when something else goes wrong.  Create the image
	subdirectory if it doesn't exist already -- thanks to Christian
	Stra√üer for the report.  Expand the filename properly.
	(muse-publish-latex-tag, muse-latex2png): Ditto on error messages
	and filename expansion.
	(muse-latex2png): Use the "muse-latex2png" prefix by default.  Set
	the default directory properly.

	* lisp/muse-publish.el (muse-style-run-hooks): Make sure that we
	do not run the same function twice.

2006-08-08  Michael Olson  <mwolson@gnu.org>

	* lisp/muse-colors.el (muse-colors-explicit-link): Fix recently
	introduced wrong-type-argument error.

	* lisp/muse-html.el (muse-html-markup-strings)
	(muse-xhtml-markup-string): Cause table definition that contains
	image to be center-aligned.  This should fix an issue with images
	not being centered when captions are very long.

	* lisp/muse-publish.el (muse-publish-table-fields): Trim
	whitespace from fields once we have split them up.

	* lisp/muse.el (muse-trim-whitespace): New function that strips
	leading and trailing whitespace from a string.

2006-08-07  Michael Olson  <mwolson@gnu.org>

	* NEWS: Update through patch-95.

	* lisp/muse-colors.el (muse-colors-lisp-tag): Use a simpler regexp
	to match the tags.
	(muse-colors-explicit-link): Show images in link descriptions if
	inlined images are enabled.

	* lisp/muse-docbook.el (muse-docbook-markup-strings): Add
	definitions for 'image-with-desc, 'image, and 'image-link.
	(muse-docbook-markup-paragraph): If an inlined image begins a
	paragraph, insert <para> before it.
	(muse-docbook-fixup-images): New function that upper-cases the
	"format" attribute of the <imagedata> tag.
	(muse-docbook-finalize-buffer): Call it.

	* lisp/muse-html.el (muse-html-markup-strings): Publish images
	with descriptions as centered tables, with a centered caption
	underneath.  The resulting look is consistent with the way that
	they are published in the LaTeX style.  Thanks to Jody Klymak for
	the suggestion.
	(muse-xhtml-markup-strings): Ditto, but XHTML apparently has no
	valid way to center a table.
	(muse-html-markup-paragraph): Use class="image" instead of
	"image-link" for paragraphs that start with an embedded image.

	* lisp/muse-latex.el (muse-latex-markup-specials-url): Use
	\textbackslash{} for "\".  Thanks to Jim Ottaway for the
	suggestion.
	(muse-latex-markup-specials-image): New option that enables
	escaping of specials in images.  This was split from the URL
	specials.
	(muse-latex-decide-specials): Handle 'image context.
	(muse-latex-fixup-dquotes): Go to beginning of document, instead
	of relying on caller to do this for us.

	* lisp/muse-publish.el (muse-publish-escape-specials): Document
	'image context.
	(muse-publish-url): Use 'image context for images.  Use 'image
	instead of 'image-link and 'image-link in place of
	'url-with-image.  Separate the image file from its extension so
	that docbook and texinfo can publish images correctly.
	(muse-publish-markup-link): Don't force a description if one is
	not given.  This fixes a bug where images without descriptions
	were being published as 'image-with-desc instead of 'image.

	* lisp/muse-texinfo.el (muse-texinfo-decide-specials): Treat
	images the same as URLs.
	(muse-texinfo-markup-strings): Improve image markup to achieve an
	effect similar to that of the LaTeX publishing style.  Simplify
	'url string.

	* lisp/muse-xml-common.el (muse-xml-decide-specials): Ditto.

	* lisp/muse.el (muse-replace-regexp-in-string): Save match data
	when we have to use the custom version of this function.

	* muse.texi (Images): Explain how to toggle inlining of images and
	give better examples.  Mention captions and that captioned images
	should not be used inside of text paragraphs.
	(Markup Strings): Bring up-to-date with the changes made since
	3.02.

2006-08-06  Michael Olson  <mwolson@gnu.org>

	* ChangeLog.1: Rename from ChangeLog.2004 to comply with standards
	in the Emacs source tree.

	* ChangeLog.2: Rename from ChangeLog.2005 to comply with standards
	in the Emacs source tree.

	* ChangeLog.3: New file created from the old ChangeLog.

	* Makefile.defs (VERSION): Set to 3.02.91.

	* NEWS: Update through patch-84.

	* lisp/muse.el (muse-version): Set to 3.02.91.

	* lisp/muse-colors.el (muse-colors-tags): Allow <lisp> to take
	attributes.
	(muse-colors-lisp-tag): Figure out where the <lisp> tag and its
	delimiter are instead of hard-coding it.

	* lisp/muse-mode.el (muse-insert-thing): Qualify "tag".
	(muse-mode): Make filling definition lists work better.  This
	should fix #5359.

	* lisp/muse-publish.el (muse-style-run-hooks): Use
	`muse-style-element' instead of `muse-get-keyword' here.  This
	should fix #6399.

	* muse.texi: Set version to 3.02.91 (3.02 RC2).

See ChangeLog.3 for earlier changes.

;; Local Variables:
;; coding: utf-8
;; End:
